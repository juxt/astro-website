---
import { Image } from 'astro:assets'
import { getImage } from 'astro:assets'
import { MarkdownInstance } from 'astro'
import { parseBlogs, slugifyPath } from '@utils/common'
import Banner from '@components/Banner.astro'
import { BlogCard } from '@components/BlogCard'
import Clickable from '@components/Clickable.astro'
import { QuoteIcon } from '@components/Icons'
import Section from '@components/Section.astro'
import ContactUsMini from '@components/ContactUsMini.tsx'
import { Blog, Person } from '@utils/types'
import CaseStudy, { CaseStudyProps } from '@layouts/CaseStudy.astro'
import Layout from '@layouts/Layout.astro'
import { ChevronRightIcon, TickIcon } from '@components/Icons'

const threadsPicture = await getImage({
  src: import('../assets/site/threads.png'),
  width: 600,
  height: 1366,
  quality: 80,
  alt: 'threads'
}).then((img) => img.src)

const siteMetadata = await Astro.glob('../data/metadata.json')

const homepageBannerPicture = await getImage({
  src: import('../assets/site/homepage-banner.jpg'),
  width: 1700,
  quality: 90,
  alt: 'homepage banner'
}).then((img) => img.src)

const testimonials = [
  {
    name: 'MORGAN ROSS, TECHNICAL DIRECTOR, ONTHEMARKET PLC',
    quote:
      'JUXT led the development team through this period of incredible achievements.',
    bg: 'bg-red-600'
  },
  {
    name: 'MANAGING DIRECTOR, T1 INVESTMENT BANK',
    quote:
      'The JUXT team are tremendously technically capable â€“ delivering elegant solutions to complex problems.',
    bg: 'bg-green-800'
  },
  {
    name: 'ANDY DWELLEY',
    quote: 'XTDB has been an absolute dream to use.',
    bg: 'bg-slate-800'
  },
  {
    name: 'PATRICK GALVIN',
    quote: 'XTDB has been working great for me. It is a lovely lovely project.',
    bg: 'bg-blue-800'
  },
  {
    name: 'JULIAN GAMBLE',
    quote:
      'JUXT have made a huge contribution to the Open Source and Clojure community',
    bg: 'bg-pink-800'
  },
  {
    name: 'NIC FERRIER',
    quote:
      'They are programmers employing programmers to do work with the best tools in the most interesting ways.',
    bg: 'bg-violet-800'
  },
  {
    name: "JACOB O'BRYANT",
    quote:
      'I really appreciate the straightforward simplicity of schemaless persistence. With XTDB it was just so easy.',
    bg: 'bg-gray-800'
  }
]

const clientLogos = [
  'credit-suisse.svg',
  'citi.svg',
  'vodafone.svg',
  'on-the-market.svg',
  'mail-online.svg',
  'klarna.svg',
  'gresham.svg'
]

const blogs = await Astro.glob<MarkdownInstance<Blog>>('./blog/{*.md,*.mdx}')

const isDev = import.meta.env.DEV

const caseStudies = await Astro.glob<CaseStudyProps>(
  '../data/case-studies/*.md'
)

const featuredCaseStudiesMetadata = siteMetadata[0].homepage.featuredCaseStudies

const featuredCaseStudies = featuredCaseStudiesMetadata.map((slug) => {
  return caseStudies.find((caseStudy) => slugifyPath(caseStudy.file) === slug)
})

const people = await Astro.glob<MarkdownInstance<Person>>(
  '../data/people/{*.mdx,*.md}'
)

const peopleByCode = new Map(
  people.map((person) => [person.frontmatter.code, person.frontmatter])
)

const featuredBlogsMetadata = siteMetadata[0].homepage.featuredBlogs

const filteredBlogs = featuredBlogsMetadata.map((slug) => {
  return blogs.find((blog) => slugifyPath(blog.url) === slug)
})

type PhaseProps = {
  title: string
  image: string
  direction?: 'left' | 'right' | 'center'
  weight: number
  content: string
}

const phases = await Astro.glob<PhaseProps>('../data/ai-engineering/*.md')

const phasesParsed = phases
  .sort((a, b) => a.frontmatter.weight - b.frontmatter.weight)
  .map((phase) => ({
    ...phase.frontmatter,
    content: phase.compiledContent()
  }))

const phaseImages = [
  import('../assets/site/jon-conj2023.png'),
  import('../assets/site/JUXT-10thBday-Wiltons-2230.png'),
  import('../assets/site/fjb.jpg'),
  import('../assets/site/mal-teaching.jpeg')
]

const heroAuthorImports = {
  heroImageImport: (heroImage) => import(`../assets/blog/${heroImage}.jpg`),
  authorImageImport: (authorImage) =>
    import(`../assets/people/${authorImage}.jpg`)
}

const featuredBlogs = await parseBlogs({
  rawBlogs: filteredBlogs,
  rawPeople: people,
  isDev: isDev,
  getImage,
  ...heroAuthorImports
})
---

<Layout title='JUXT' navbar navbarNoBg>
  <main>
    <Banner
      navbarNoBg
      text='Scaling Simplicity'
      style={{
        backgroundImage: `url(${homepageBannerPicture})`
      }}
    />
    <div class='bg-black flex flex-wrap justify-center border-gray-800'>
      {
        clientLogos.map((logo) => (
          <img
            src={`/images/client-logos/${logo}`}
            alt={`${logo.replace('.svg', '')} company logo`}
            class='w-25 h-20 md:w-35 md:h-30'
          />
        ))
      }
    </div>
    <Section className='bg-gray-900 py-12 text-white'>
      <h2 class='text-3xl md:text-4xl pb-10'>AI-assisted engineering that unlocks your organization's potential</h2>
      <p class='text-xl md:text-2xl font-extralight pb-6'>
        For over a decade, we've built high-quality, scalable, and resilient
        software systems for the world's largest companies, without fail.
      </p>
      <h3 class='text-xl md:text-2xl font-extralight'>
        AI-assisted development is moving from experimentation to enterprise
        adoption. We help engineering teams introduce it with rigour, measure its
        impact with credible metrics, and scale it to deliver concrete results.
      </h3>
      <div
        class='pt-16 flex flex-col items-center sm:items-start sm:flex-row flex-wrap gap-6'
      >
        {
          phasesParsed.map((phase, idx) => (
            <Clickable>
              <a
                href={`#phase-${idx}`}
                class='capitalize block py-1.5 px-1.5 text-2xl'
              >
                {phase.title}
              </a>
            </Clickable>
          ))
        }
      </div>
    </Section>
    <div class='flex flex-col text-black'>
      {
        phasesParsed.map((phase, idx) => {
          const isDark = idx % 2 !== 0
          const isLeft = phase.direction === 'left' || !phase.direction

          const sectionStyle = isLeft
            ? 'flex-col-reverse xl:flex-row-reverse'
            : 'flex-col-reverse xl:flex-row'

          return (
            <Section
              id={`phase-${idx}`}
              className={`${isDark ? 'bg-black text-white' : ''} py-28`}
            >
              <div
                class={`flex items-center xl:items-start gap-16 ${sectionStyle}`}
              >
                {phaseImages[idx] && (
                  <div class='w-full xl:w-1/2 h-96'>
                    <Image
                      alt={phase.title}
                      width={500}
                      quality={80}
                      class='w-full h-full object-cover'
                      src={phaseImages[idx]}
                    />
                  </div>
                )}
                <div class='md:w-2/3 xl:w-1/2'>
                  <h2 class='text-5xl font-light pb-8'>{phase.title}</h2>
                  <div class='flex flex-col gap-8'>
                    <div
                      class='flex [&_li]:list-disc flex-col gap-6 text-lg font-extralight'
                      {/* eslint-disable-next-line */}
                      set:html={phase.content}
                    />
                  </div>
                </div>
              </div>
            </Section>
          )
        })
      }
    </div>

    <Section
      className={'bg-gient-to-b from-black to bg-gray-600 bg-[length:0px_0px] md:bg-no-repeat md:bg-right md:bg-contain pt-16 pb-20 text-white'}
    >
      <div class='flex justify-center pb-10'>
        <h2 class='text-4xl lg:text-5xl font-bold'>Our Approach</h2>
      </div>
      <div class='text-xl leading-relaxed font-extralight flex flex-col gap-6 max-w-3xl mx-auto text-left'>
        <p>
          We use AI to build software and we build systems that use AI.
          Both demand deep engineering skill applied with discipline. AI
          tooling rewards teams who already know what good software looks
          like. We bring that knowledge, grounded in four principles:
          <span class='font-bold text-juxt'>simplicity</span>,
          <span class='font-bold text-juxt'>evidence</span>,
          <span class='font-bold text-juxt'>judgement</span> and
          <span class='font-bold text-juxt'>rigour</span>.
        </p>
        <p>
          These principles shape everything we deliver, resulting in:
        </p>
        <div class='grid grid-cols-1 md:grid-cols-2 gap-4 text-left text-sm'>
          <div class='flex gap-3 items-center'>
            <div class='bg-gray-800 w-5 h-5 shrink-0 border border-juxt'>
              <TickIcon className={'fill-white'} />
            </div>
            <p>Rapid development of large IT systems</p>
          </div>
          <div class='flex gap-3 items-center'>
            <div class='bg-gray-800 w-5 h-5 shrink-0 border border-juxt'>
              <TickIcon className={'fill-white'} />
            </div>
            <p>Increased levels of agility and software re-use</p>
          </div>
          <div class='flex gap-3 items-center'>
            <div class='bg-gray-800 w-5 h-5 shrink-0 border border-juxt'>
              <TickIcon className={'fill-white'} />
            </div>
            <p>Lower maintenance costs</p>
          </div>
          <div class='flex gap-3 items-center'>
            <div class='bg-gray-800 w-5 h-5 shrink-0 border border-juxt'>
              <TickIcon className={'fill-white'} />
            </div>
            <p>Secure, reliable systems that are robust yet flexible</p>
          </div>
        </div>
      </div>
      <div class='flex justify-between flex-col lg:flex-row'>
        <div class='lg:w-1/2'>
          <h2 class='text-3xl lg:text-4xl font-semibold pt-20 pb-10'>Simplicity</h2>
          <div class='font-extralight text-xl leading-relaxed flex flex-col gap-6'>
            <p>
              The central problem in software engineering is accidental
              complexity, the unnecessary kind that accumulates when concerns
              that should be separate get tangled together. These tangles
              resist every future change.
            </p>
            <p>
              AI-assisted development produces code fast, but speed compounds
              whatever structure is already in place. If the foundations are
              simple, that compounds well. If they aren't, you get a bigger
              mess, sooner. Simplicity isn't an aesthetic preference. It's an
              engineering discipline, and a hard-won one.
            </p>
          </div>
        </div>
        <div
          class='lg:w-1/2 lg:mt-10 flex justify-center overflow-hidden'
        >
          <Image
            alt='image'
            width={500}
            quality={80}
            class='sm:w-3/5 lg:w-2/3 aspect-square object-contain animate-[spin_100s_linear_infinite]'
            src={import('../assets/site/sphere-time.png')}
          />
        </div>
      </div>
      <div class='flex justify-between flex-col-reverse lg:flex-row text-white'>
        <div
          class='lg:w-1/2 lg:mt-10 flex justify-center overflow-hidden'
        >
          <Image
            alt='image'
            width={500}
            quality={80}
            class='sm:w-3/5 lg:w-2/3 animate-[spin_100s_linear_infinite]'
            src={import('../assets/site/sphere-data.png')}
          />
        </div>
        <div class='lg:w-1/2'>
          <h2 class='text-3xl lg:text-4xl font-semibold py-10'>Evidence</h2>
          <div class='font-extralight text-xl leading-relaxed flex flex-col gap-6'>
            <p>
              Every team is different, and every individual within a team is
              different. What works in one context won't work in another, and
              the only way to know is to measure. We track the things that
              matter: velocity and quality.
            </p>
            <p>
              We also track the things that matter to you, and report on them
              honestly, to demonstrate that we're adding value, to understand
              where to coach, where to intervene and where to get out of the
              way.
            </p>
          </div>
        </div>
      </div>
      <div class='flex justify-between flex-col lg:flex-row'>
        <div class='lg:w-1/2'>
          <h2 class='text-3xl lg:text-4xl font-semibold py-10'>Judgement</h2>
          <div class='font-extralight text-xl leading-relaxed flex flex-col gap-6'>
            <p>
              AI makes code cheaper to produce, which shifts the bottleneck
              from writing software to evaluating it. Cognitive offloading is
              useful, but only up to the point where engineers still understand
              what's been offloaded. Past that point, you're accumulating debt
              you can't see.
            </p>
            <p>
              Keeping human judgement sharp at the moments that matter,
              architecture, design trade-offs, the decisions that tools can't
              make, is what separates teams that move fast from teams that
              just produce a lot.
            </p>
          </div>
        </div>
        <div
          class='lg:w-1/2 lg:mt-10 flex justify-center overflow-hidden'
        >
          <Image
            alt='image'
            width={500}
            quality={80}
            class='sm:w-3/5 lg:w-2/3 animate-[spin_100s_linear_infinite]'
            src={import('../assets/site/sphere-form.png')}
          />
        </div>
      </div>
      <div class='flex justify-between flex-col-reverse lg:flex-row text-white'>
        <div
          class='lg:w-1/2 lg:mt-10 flex justify-center overflow-hidden relative'
        >
          <Image
            alt='image'
            width={500}
            quality={80}
            class='sm:w-3/5 lg:w-2/3 animate-[spin_100s_linear_infinite]'
            src={import('../assets/site/sphere-code.png')}
          />
          <div class='absolute inset-0 flex justify-center'>
            <Image
              alt='image'
              width={500}
              quality={80}
              class='sm:w-3/5 lg:w-2/3 animate-[spin_100s_linear_infinite]'
              src={import('../assets/site/sphere-form.png')}
            />
          </div>
        </div>
        <div class='lg:w-1/2 pb-16'>
          <h2 class='text-3xl lg:text-4xl font-semibold py-10'>Rigour</h2>
          <div class='font-extralight text-xl leading-relaxed flex flex-col gap-6'>
            <p>
              Software that degrades the experience for customers, frustrates
              the developers maintaining it or falls over under load is just a
              liability shipped sooner. Velocity only counts when the thing
              being delivered works. For users. For the team. For the
              business that depends on it.
            </p>
            <p>
              Operational soundness, user experience and reliability
              aren't extras you bolt on when there's time. They're the
              baseline. Without them, nothing else you ship matters.
            </p>
          </div>
        </div>
      </div>
    </Section>

    <Section className='text-black py-20 md:py-40 bg-gray-100'>
      <ContactUsMini client:only />
    </Section>
  </main>
</Layout>
